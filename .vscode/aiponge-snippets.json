{
  "aiponge-api-route": {
    "prefix": "ap-route",
    "body": [
      "// ${1:Description} API route",
      "${2:router}.${3:get}('${4:/}', ${5:UnifiedAuthService.requireAuth, }asyncErrorHandler(async (req: ${6:AuthenticatedRequest}, res: Response) => {",
      "  return UnifiedErrorHandler.execute(async () => {",
      "    ${7:// Your business logic here}",
      "    const ${8:result} = await ${9:YourService}.${10:method}(${11:req.user!.id, req.body});",
      "    sendSuccessResponse(res, ${8:result}, '${12:Operation completed successfully}');",
      "  }, ",
      "  { service: 'APIGateway', operation: '${10:method}'${13:, userId: req.user!.id} },",
      "  ErrorType.${14:DATABASE}",
      "  );",
      "}));"
    ],
    "description": "Aiponge API route template with error handling and auth"
  },

  "aiponge-service-method": {
    "prefix": "ap-service",
    "body": [
      "/**",
      " * ${1:Description of what this method does}",
      " */",
      "static async ${2:methodName}(${3:parameters}) {",
      "  return UnifiedErrorHandler.execute(async () => {",
      "    logger.info('${4:Starting operation}', { ",
      "      service: '${5:YourService}', ",
      "      operation: '${2:methodName}',",
      "      ${6:userId,}",
      "      metadata: { ${7:// Additional context} }",
      "    });",
      "    ",
      "    ${8:// Your business logic here}",
      "    const ${9:result} = await storage.${10:databaseMethod}(${11:parameters});",
      "    ",
      "    logger.success('${12:Operation completed}', {",
      "      service: '${5:YourService}',",
      "      operation: '${2:methodName}',",
      "      ${6:userId,}",
      "      metadata: { ${13:// Result metadata} }",
      "    });",
      "    ",
      "    return ${9:result};",
      "  }, ",
      "  { service: '${5:YourService}', operation: '${2:methodName}'${14:, userId} },",
      "  ErrorType.${15:DATABASE}",
      "  );",
      "}"
    ],
    "description": "Aiponge service method template with logging and error handling"
  },

  "aiponge-database-method": {
    "prefix": "ap-db",
    "body": [
      "async ${1:methodName}(${2:parameters}) {",
      "  ${3:// Select operation}",
      "  return this.${4:userDB}.select()",
      "    .from(${5:tableName})",
      "    .where(${6:condition});",
      "  ",
      "  ${7:// Insert operation}",
      "  // const [result] = await this.${4:userDB}.insert(${5:tableName})",
      "  //   .values(${8:data})",
      "  //   .returning();",
      "  // return result;",
      "  ",
      "  ${9:// Update operation}",
      "  // const [result] = await this.${4:userDB}.update(${5:tableName})",
      "  //   .set(${10:updates})",
      "  //   .where(${11:condition})",
      "  //   .returning();",
      "  // return result;",
      "  ",
      "  ${12:// Delete operation}",
      "  // await this.${4:userDB}.delete(${5:tableName})",
      "  //   .where(${13:condition});",
      "}"
    ],
    "description": "Aiponge database method template with common operations"
  },

  "aiponge-external-api": {
    "prefix": "ap-external",
    "body": [
      "/**",
      " * ${1:Description of external API integration}",
      " */",
      "static async ${2:methodName}(${3:parameters}) {",
      "  return UnifiedErrorHandler.execute(async () => {",
      "    logger.info('Calling external API', { ",
      "      service: '${4:YourService}', ",
      "      operation: '${2:methodName}',",
      "      metadata: { ${5:// API parameters} }",
      "    });",
      "    ",
      "    const response = await fetch('${6:https://api.example.com/endpoint}', {",
      "      method: '${7:POST}',",
      "      headers: { ",
      "        'Content-Type': 'application/json',",
      "        'Authorization': `Bearer \\${process.env.${8:API_KEY}}`",
      "      },",
      "      body: JSON.stringify(${9:requestData})",
      "    });",
      "    ",
      "    if (!response.ok) {",
      "      throw new Error(`API error: \\${response.status} - \\${response.statusText}`);",
      "    }",
      "    ",
      "    const ${10:result} = await response.json();",
      "    ",
      "    logger.success('External API call successful', {",
      "      service: '${4:YourService}',",
      "      operation: '${2:methodName}',",
      "      metadata: { ${11:// Response metadata} }",
      "    });",
      "    ",
      "    return ${10:result};",
      "  }, ",
      "  { service: '${4:YourService}', operation: '${2:methodName}' },",
      "  ErrorType.EXTERNAL_API  // Circuit breaker + retry logic",
      "  );",
      "}"
    ],
    "description": "Aiponge external API integration template with circuit breaker"
  },

  "aiponge-schema-table": {
    "prefix": "ap-schema",
    "body": [
      "export const ${1:tableName} = pgTable('${2:table_name}', {",
      "  id: serial('id').primaryKey(),",
      "  ${3:userId}: integer('user_id').notNull(),",
      "  ${4:// Add your columns here}",
      "  ${5:name}: varchar('name', { length: 255 }).notNull(),",
      "  ${6:description}: text('description'),",
      "  ${7:isActive}: boolean('is_active').default(true),",
      "  createdAt: timestamp('created_at').defaultNow(),",
      "  updatedAt: timestamp('updated_at').defaultNow().$onUpdate(() => new Date())",
      "});",
      "",
      "// Insert schema for validation",
      "export const insert${8:TableName}Schema = createInsertSchema(${1:tableName}).omit({",
      "  id: true,",
      "  createdAt: true,",
      "  updatedAt: true",
      "});",
      "",
      "// TypeScript types",
      "export type ${8:TableName} = typeof ${1:tableName}.$inferSelect;",
      "export type Insert${8:TableName} = z.infer<typeof insert${8:TableName}Schema>;"
    ],
    "description": "Aiponge database schema table template"
  },

  "aiponge-background-job": {
    "prefix": "ap-job",
    "body": [
      "// Add background job",
      "const { jobQueue } = await import('./job-queue');",
      "await jobQueue.addJob('${1:job-name}', {",
      "  ${2:userId}: ${3:req.user!.id},",
      "  ${4:// Job parameters}",
      "  priority: '${5:normal}' // high, normal, low",
      "});",
      "",
      "logger.info('Background job queued', {",
      "  service: '${6:YourService}',",
      "  operation: 'queueJob',",
      "  metadata: { jobType: '${1:job-name}' }",
      "});"
    ],
    "description": "Aiponge background job template"
  },

  "aiponge-websocket-broadcast": {
    "prefix": "ap-ws",
    "body": [
      "// Broadcast real-time update",
      "const { WebSocketService } = await import('./websocket-service');",
      "await WebSocketService.broadcastToUser(${1:userId}, {",
      "  type: '${2:update_type}',",
      "  data: {",
      "    ${3:// Your update data}",
      "  }",
      "});",
      "",
      "logger.info('Real-time update sent', {",
      "  service: '${4:YourService}',",
      "  operation: 'broadcastUpdate',",
      "  userId: ${1:userId},",
      "  metadata: { updateType: '${2:update_type}' }",
      "});"
    ],
    "description": "Aiponge WebSocket broadcast template"
  },

  "aiponge-validation": {
    "prefix": "ap-validate",
    "body": [
      "// Request validation",
      "const ${1:validatedData} = ${2:insertSchema}.parse(req.body);",
      "",
      "// Parameter validation",
      "const ${3:id} = parseInt(req.params.${4:id});",
      "if (isNaN(${3:id})) {",
      "  throw new Error('Invalid ${4:id} parameter');",
      "}",
      "",
      "// User authorization check",
      "if (${5:resource}.userId !== req.user!.id) {",
      "  return res.status(403).json({ error: 'Access denied: You can only access your own ${6:resources}' });",
      "}"
    ],
    "description": "Aiponge validation patterns"
  }
}